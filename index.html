<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Ç¥„É´„Éï„Ç≥„É≥„ÉöÁµêÊûúÁô∫Ë°®</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; }
        .revealed { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 pb-20">

    <div class="max-w-md mx-auto min-h-screen bg-gray-50 shadow-xl relative">
        
        <!-- Header -->
        <div class="bg-green-800 text-white p-6 rounded-b-3xl shadow-lg z-10 relative">
            <h1 class="text-2xl font-bold mb-1">Golf Results ‚õ≥Ô∏è</h1>
            <p class="text-green-200 text-xs">Êóß„Éö„É™ / ÈùíÂ§©‰∫ï / Èö†„Åó„Éõ„Éº„É´Âõ∫ÂÆö</p>
            
            <!-- Tabs -->
            <div class="mt-6 flex bg-green-900/50 p-1 rounded-full">
                <button onclick="switchTab('IN')" id="tab-in" class="flex-1 py-2 rounded-full text-sm font-bold transition-all bg-white text-green-900 shadow">
                    IN CUP
                </button>
                <button onclick="switchTab('OUT')" id="tab-out" class="flex-1 py-2 rounded-full text-sm font-bold transition-all text-green-100 hover:text-white">
                    OUT CUP
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="p-4 space-y-4">
            
            <!-- Action Button -->
            <div id="action-area" class="sticky top-4 z-20">
                <button id="reveal-btn" onclick="revealNext()" class="w-full bg-green-600 hover:bg-green-500 active:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg text-lg transition-all transform active:scale-95 flex items-center justify-center gap-2 border-b-4 border-green-800">
                    <span id="btn-text">8‰Ωç „ÇíÁô∫Ë°®</span>
                </button>
                <div id="finished-msg" class="hidden w-full bg-gray-800 text-white font-bold py-4 rounded-xl text-center shadow-inner">
                    Áô∫Ë°®ÁµÇ‰∫Ü„Å£„Åô
                </div>
            </div>

            <!-- Ranking List -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                <div class="bg-gray-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center">
                    <h2 class="font-bold text-gray-700" id="list-title">IN Results</h2>
                    <span class="text-xs text-gray-400">NetÈ†Ü</span>
                </div>
                <div id="ranking-list" class="divide-y divide-gray-100">
                    <!-- Rows will be injected here -->
                </div>
            </div>

            <!-- Hidden Holes Info -->
            <div class="mt-8 bg-white rounded-xl shadow-sm border border-gray-200 p-4">
                <p class="text-xs text-gray-400 font-bold mb-2 uppercase">Èö†„Åó„Éõ„Éº„É´ (Âõ∫ÂÆö)</p>
                <div id="hidden-holes-display" class="flex gap-2">
                    <!-- Badges -->
                </div>
            </div>

        </div>
    </div>

    <script>
        // Data
        const PLAYERS = [
            { id: 1, name: 'Áî∫Áî∞ Âïì', in: [6, 7, 5, 4, 3, 4, 6, 3, 6], out: [4, 4, 6, 7, 4, 5, 4, 6, 8] },
            { id: 2, name: '‰∏∏Â±± ÁøîÂè∏', in: [8, 7, 5, 6, 4, 4, 7, 3, 6], out: [5, 3, 4, 8, 3, 4, 5, 8, 6] },
            { id: 3, name: 'Â≤°Áî∞ Â∫∑Âπ≥', in: [8, 7, 11, 7, 3, 5, 6, 6, 7], out: [7, 6, 7, 8, 5, 9, 7, 6, 9] },
            { id: 4, name: 'Ê•†Áî∞ Âü∫Âºò', in: [5, 9, 6, 6, 6, 5, 7, 3, 6], out: [8, 5, 9, 6, 5, 8, 6, 8, 11] },
            { id: 5, name: 'ÈΩãËó§ ËøÖ', in: [9, 8, 6, 6, 6, 6, 7, 4, 7], out: [7, 6, 8, 9, 6, 6, 9, 9, 6] },
            { id: 6, name: 'ÈÖí‰∫ï ÂãáÊ®π', in: [8, 6, 5, 5, 3, 5, 8, 5, 7], out: [5, 7, 6, 7, 3, 6, 5, 6, 8] },
            { id: 7, name: 'È´òÊ©ã ÂãáÂ∏å', in: [6, 6, 7, 4, 4, 6, 6, 6, 8], out: [6, 5, 7, 11, 7, 6, 6, 5, 7] },
            { id: 8, name: '‰∏≠Êùë ÊïèÊúó', in: [5, 6, 8, 8, 5, 6, 8, 6, 7], out: [7, 5, 8, 7, 3, 8, 9, 5, 7] }
        ];

        const HOLE_NAMES_IN = [10, 11, 12, 13, 14, 15, 16, 17, 18];
        const HOLE_NAMES_OUT = [1, 2, 3, 4, 5, 6, 7, 8, 9];

        // Fixed Hidden Holes (Indices 0-8)
        // IN: 11(idx 1), 14(idx 4), 17(idx 7)
        const HIDDEN_IN = [1, 4, 7]; 
        // OUT: 2(idx 1), 5(idx 4), 8(idx 7) -> Just picking same relative positions for simplicity
        const HIDDEN_OUT = [1, 4, 7];

        let currentTab = 'IN';
        let revealStepIn = 0;
        let revealStepOut = 0;

        // Calc Logic
        function calculate(scores, hiddenIndices) {
            const gross = scores.reduce((a, b) => a + b, 0);
            const hiddenSum = hiddenIndices.reduce((sum, idx) => sum + scores[idx], 0);
            
            // Old Peoria: (HiddenSum * 3 - 36) * 0.8
            // 9 Holes Par is 36
            let handicap = ((hiddenSum * 3) - 36) * 0.8;
            
            // Rounding
            handicap = Math.round(handicap * 10) / 10;
            const net = Math.round((gross - handicap) * 10) / 10;
            
            return { gross, handicap, net };
        }

        function getSortedData(type) {
            const hidden = type === 'IN' ? HIDDEN_IN : HIDDEN_OUT;
            const key = type === 'IN' ? 'in' : 'out';
            
            const results = PLAYERS.map(p => {
                const res = calculate(p[key], hidden);
                return { ...p, ...res };
            });

            // Sort by Net ASC
            return results.sort((a, b) => a.net - b.net);
        }

        function renderList() {
            const listEl = document.getElementById('ranking-list');
            const data = getSortedData(currentTab);
            const step = currentTab === 'IN' ? revealStepIn : revealStepOut;
            const revealLimitIndex = 8 - step; // Index below which is hidden
            
            // Example: Step 0. Limit 8. All rows with rank > 8 (none) revealed? No.
            // Logic:
            // We want to show Rank 8 first (bottom of list).
            // Rank 1 is index 0. Rank 8 is index 7.
            // Step 1: Show Rank 8. (Index 7).
            // Step 2: Show Rank 7. (Index 6).
            // So, items with index >= (8 - step) are revealed.
            
            const thresholdIndex = 8 - step; 
            
            let html = '';
            
            data.forEach((player, idx) => {
                const rank = idx + 1;
                const isRevealed = idx >= thresholdIndex;
                const isNext = idx === thresholdIndex - 1; // The one about to be revealed (optional effect)

                if (isRevealed) {
                    const isWinner = rank === 1;
                    const bgClass = isWinner ? 'bg-yellow-50' : 'bg-white';
                    const icon = isWinner 
                        ? '<span class="text-2xl">üèÜ</span>' 
                        : `<span class="font-bold text-xl ${rank <= 3 ? 'text-gray-700' : 'text-gray-400'}">${rank}</span>`;
                    
                    const textClass = isWinner ? 'text-yellow-800' : 'text-gray-800';
                    const netClass = isWinner ? 'text-yellow-600' : 'text-gray-700';

                    html += `
                        <div class="flex items-center p-4 border-b border-gray-100 revealed transition-colors ${bgClass}">
                            <div class="w-12 text-center flex justify-center">${icon}</div>
                            <div class="flex-1">
                                <div class="font-bold text-lg ${textClass}">${player.name}</div>
                                <div class="text-xs text-gray-500 font-mono space-x-2">
                                    <span>G:${player.gross}</span>
                                    <span>HDCP:${player.handicap.toFixed(1)}</span>
                                </div>
                            </div>
                            <div class="text-xl font-bold font-mono ${netClass}">${player.net.toFixed(1)}</div>
                        </div>
                    `;
                } else {
                    // Hidden row
                    html += `
                        <div class="flex items-center p-4 bg-gray-50 border-b border-gray-100 opacity-50">
                            <div class="w-12 text-center font-bold text-xl text-gray-300">?</div>
                            <div class="flex-1 font-medium text-gray-300">???</div>
                            <div class="text-sm text-gray-300">Net: ???</div>
                        </div>
                    `;
                }
            });
            
            listEl.innerHTML = html;
            updateUI();
        }

        function updateUI() {
            const step = currentTab === 'IN' ? revealStepIn : revealStepOut;
            const nextRank = 8 - step;
            const btn = document.getElementById('reveal-btn');
            const btnText = document.getElementById('btn-text');
            const finishedMsg = document.getElementById('finished-msg');
            const listTitle = document.getElementById('list-title');

            listTitle.textContent = `${currentTab} Results`;

            if (step >= 8) {
                btn.classList.add('hidden');
                finishedMsg.classList.remove('hidden');
            } else {
                btn.classList.remove('hidden');
                finishedMsg.classList.add('hidden');
                btnText.textContent = `#${nextRank}‰Ωç „ÇíÁô∫Ë°®`;
            }

            // Tabs styling
            const tIn = document.getElementById('tab-in');
            const tOut = document.getElementById('tab-out');
            if (currentTab === 'IN') {
                tIn.className = "flex-1 py-2 rounded-full text-sm font-bold transition-all bg-white text-green-900 shadow";
                tOut.className = "flex-1 py-2 rounded-full text-sm font-bold transition-all text-green-100 hover:text-white";
            } else {
                tOut.className = "flex-1 py-2 rounded-full text-sm font-bold transition-all bg-white text-green-900 shadow";
                tIn.className = "flex-1 py-2 rounded-full text-sm font-bold transition-all text-green-100 hover:text-white";
            }

            // Hidden holes display
            const hiddenContainer = document.getElementById('hidden-holes-display');
            const holes = currentTab === 'IN' ? HOLE_NAMES_IN : HOLE_NAMES_OUT;
            const hiddenIndices = currentTab === 'IN' ? HIDDEN_IN : HIDDEN_OUT;
            
            let hHtml = '';
            holes.forEach((h, idx) => {
                const isHidden = hiddenIndices.includes(idx);
                if (isHidden) {
                    hHtml += `<div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold bg-yellow-400 text-yellow-900 shadow-sm">${h}</div>`;
                } else {
                    hHtml += `<div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold bg-gray-200 text-gray-400">${h}</div>`;
                }
            });
            hiddenContainer.innerHTML = hHtml;
        }

        function revealNext() {
            if (currentTab === 'IN') {
                if (revealStepIn < 8) revealStepIn++;
            } else {
                if (revealStepOut < 8) revealStepOut++;
            }
            renderList();
        }

        function switchTab(tab) {
            currentTab = tab;
            renderList();
        }

        // Init
        renderList();

    </script>
</body>
</html>

